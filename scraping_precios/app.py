import streamlit as st
import pandas as pd
import requests
from datetime import datetime

# -------------------
# üîπ COOKIE de Hiper Olivos
# -------------------
COOKIE_SEGMENT = "eyJjYW1wYWlnbnMiOm51bGwsImNoYW5uZWwiOiIxIiwicHJpY2VUYWJsZXMiOm51bGwsInJlZ2lvbklkIjpudWxsLCJ1dG1fY2FtcGFpZ24iOm51bGwsInV0bV9zb3VyY2UiOm51bGwsInV0bWlfY2FtcGFpZ24iOm51bGwsImN1cnJlbmN5Q29kZSI6IkFSUyIsImN1cnJlbmN5U3ltYm9sIjoiJCIsImNvdW50cnlDb2RlIjoiQVJHIiwiY3VsdHVyZUluZm8iOiJlcy1BUiIsImFkbWluX2N1bHR1cmVJbmZvIjoiZXMtQVIiLCJjaGFubmVsUHJpdmFjeSI6InB1YmxpYyJ9"

HEADERS = {
    "User-Agent": "Mozilla/5.0",
    "Cookie": f"vtex_segment={COOKIE_SEGMENT}"
}

# -------------------
# üîπ Diccionario de productos (Nombre: productId)
# -------------------
productos = {
    ‚ÄúANILLOS CLASICOS 24X170G‚Äù: ‚Äú7622201808884‚Äù,
‚ÄúANILLOS CLASICOS 24X300G‚Äù: ‚Äú7622201504007‚Äù,
‚ÄúBOCA DE DAMA 20X170G‚Äù: ‚Äú7622201808860‚Äù,
‚ÄúCEREALITAS TOSTADAS ARROZ 24 x 160 GRS.‚Äù: ‚Äú7622300160975‚Äù,
‚ÄúCLUB SC JAMON 44MPX6UNX23,5G NEW‚Äù: ‚Äú7622210692245‚Äù,
‚ÄúCLUB ORIGINAL 44PKX6UNX24G VSA SC‚Äù: ‚Äú7622300990732‚Äù,
‚ÄúDUQUESA TOONIX 36 PQ. X 115 GR‚Äù: ‚Äú7622300742645‚Äù,
‚ÄúDUQUESA 12X345G ‚Äú: ‚Äú7622202218729‚Äù,
‚ÄúMELBA 12X360G TRIPACK‚Äù: ‚Äú7794600004539‚Äù,
‚ÄúMELBA ANGRY BIRDS 36X120G‚Äù: ‚Äú7622300829728‚Äù,
‚ÄúGALLETA MILKA VAI 36X124G‚Äù: ‚Äú7622202210051‚Äù,
‚ÄúGALLETA MILKA CHOCO 36X124G‚Äù: ‚Äú7622202210075‚Äù,
‚ÄúMINI OREO 54X50G ‚Äù: ‚Äú7622201761288‚Äù,
‚ÄúOREO GOLDEN QI 12X354G‚Äù: ‚Äú7622201806538‚Äù,
‚ÄúOREO GOLDEN QI 36X118G‚Äù: ‚Äú7622201806552‚Äù,
‚ÄúOREO REGULAR 42X182,5G‚Äù: ‚Äú7622201735821‚Äù,
‚ÄúOREO REG SINGLE 36X118G‚Äù: ‚Äú7622201735296‚Äù,
‚ÄúOREO MILKSHAKE FRU 36X118G L13‚Äù: ‚Äú7622202049057‚Äù,
‚ÄúOREO REG TRIPACK 12X354G‚Äù: ‚Äú7622201735258‚Äù,
‚ÄúOREO MAN√ç 36X118G L13 ‚Äù: ‚Äú7622202302862‚Äù,
‚ÄúPEPITOS REG SINGLE 60X119G‚Äù: ‚Äú7622201735906‚Äù,
‚ÄúTERRA CCC 24X144G ‚Äú: ‚Äú7622201385279‚Äù,
‚ÄúTERRABUSI SCONS 36X160G‚Äù: ‚Äú7622201491611‚Äù,
‚ÄúGALLETA TERRABUSI VAINILLA 60X120G‚Äù: ‚Äú7622202220555‚Äù,
‚ÄúGALLETA TERRABUSI MIEL 60X120G‚Äù: ‚Äú7622202220579‚Äù,
‚ÄúMINI PEPITOS 54X50G‚Äù: ‚Äú7622201740399‚Äù,
‚ÄúPEPITOS REG TRIPACK 20X357G‚Äù: ‚Äú7622201735883‚Äù,
‚ÄúLINCOLN CLASICAS 2023 PN 60X153G‚Äù: ‚Äú7622201386719‚Äù,
‚ÄúLINCOLN CLASICAS 2023 60X153G‚Äù: ‚Äú7622201386719‚Äù,
‚ÄúLINCOLN CLASICA TRIPACK 2023 20X459‚Äù: ‚Äú7622201745547‚Äù,
‚ÄúLINCOLN CHOCO 60X153G‚Äù: ‚Äú7622300742676‚Äù,
‚ÄúLINCOLN COCO 60X153G‚Äù: ‚Äú7622300742713‚Äù,
‚ÄúVARIEDAD NUEVO MIX 2023 16X590G‚Äù: ‚Äú7622201745585‚Äù,
‚ÄúCEREALITAS ARROZ RS 24X160G‚Äù: ‚Äú7622201753061‚Äù,
‚ÄúOREO CHOCO 36X118G L13‚Äù: ‚Äú7622202049033‚Äù,
‚ÄúOREO CHOCO 36X118G‚Äù: ‚Äú7622201735845‚Äù,
‚ÄúVARIEDAD CHOCO 24X300G‚Äù: ‚Äú7622201503987‚Äù,
‚ÄúVARIEDAD DORADA 24X300G‚Äù: ‚Äú7622201503963‚Äù,
‚ÄúLINCOLN CLASICAS 2023 36X219G‚Äù: ‚Äú7622201735319‚Äù,
‚ÄúMANON L7 45X182G‚Äù: ‚Äú7622201385255‚Äù,
‚ÄúOREO REG 36X118G L16‚Äù: ‚Äú7622201735272‚Äù,
‚ÄúVARIEDAD NUEVO MIX 2023 36X170G‚Äù: ‚Äú7622201745639‚Äù,
‚ÄúVARIEDAD NUEVO MIX 2023 20X390G‚Äù: ‚Äú7622201745561‚Äù,
‚ÄúOREO BANADAS CHOCO 16X119G‚Äù: ‚Äú7622201740375‚Äù,
‚ÄúOREO BANADAS BCO 16X119G‚Äù: ‚Äú7622201745615‚Äù,
‚ÄúOREO SIN TACC 24X95G‚Äù: ‚Äú7622202038099‚Äù,
‚ÄúMINI OREO WE 12X150G‚Äù: ‚Äú7622202219337‚Äù,
‚ÄúCEREALITAS AVENA CACAO24 48X170G‚Äù: ‚Äú7622202241505‚Äù,
‚ÄúCEREALITAS GRANOLA24 48X170G‚Äù: ‚Äú7622202241567‚Äù,
‚ÄúCEREALITAS SALVADO X3 15X624G ‚Äú: ‚Äú7622201746032‚Äù,
‚ÄúCEREALITAS SALVADO 45X208G‚Äù: ‚Äú7622201745981‚Äù,
‚ÄúCEREALITAS CLASICAS X3 15X636G‚Äù: ‚Äú7622201745905‚Äù,
‚ÄúCEREALITAS CLASICAS 45X212G‚Äù: ‚Äú7622201736033‚Äù,
‚ÄúBUBBA GOMITA C BLUEBERRY 14X82,5GR‚Äù: ‚Äú7622202216473‚Äù,
‚ÄúBUBBA GOMITA FRUTILLA CIT 14X82,5GR‚Äù: ‚Äú7622202216510‚Äù,
‚ÄúBUBBA GOMITA FRUTILLA 12DX12UX15G‚Äù: ‚Äú7622202216589‚Äù,
‚ÄúBUBBA GOMITA MIX CIT 12DX12UX16,5G‚Äù: ‚Äú7622202217265‚Äù,
‚ÄúBUBBA GOMITA FRUTILLA CIT 12DX12UX16,5G‚Äù: ‚Äú7622202217296‚Äù,
‚ÄúBUBBA CRACKUPS  18X18X24G‚Äù: ‚Äú7622202228490‚Äù,
‚ÄúBUBBA CRACKUPS  12X12X72G‚Äù: ‚Äú7622202228469‚Äù,
‚ÄúCARAMELOS CLIGHT NARANJA 18X12‚Äù: ‚Äú7622300803698‚Äù,
‚ÄúCAR.CLIGHT FRAMBUESA‚Äù: ‚Äú7622300835194‚Äù,
‚ÄúCAR HALLS XTRA STRONG 24X12‚Äù: ‚Äú77986283‚Äù,
‚ÄúCAR HALLS SANDIA 24X12X28g‚Äù: ‚Äú77987679‚Äù,
‚ÄúCAR HALLS MENTHO 24X12X28g‚Äù: ‚Äú77987655‚Äù,
‚ÄúCAR HALLS SANDIA 30X12X25.2G‚Äù: ‚Äú7622202247361‚Äù,
‚ÄúCAR HALLS CHERRY 30X12X25.2G‚Äù: ‚Äú7622202247286‚Äù,
‚ÄúCAR HALLS MENTALYPTUS 30X12X25.2G‚Äù: ‚Äú7622202247316‚Äù,
‚ÄúCAR HALLS MENTHO 30X12X25.2G‚Äù: ‚Äú7622202247392‚Äù,
‚ÄúHALLS STANI MIEL C/LIMON 24X12X28GR‚Äù: ‚Äú77905277‚Äù,
‚ÄúHALLS STANI MIEL C/MENTA 24X12X28GR‚Äù: ‚Äú77905291‚Äù,
‚ÄúCAR. HALLS VITA C FRUTILLA 24x12 D11‚Äù: ‚Äú77917317‚Äù,
‚ÄúCAR. HALLS VITA C NARANJA 24x12 D11‚Äù: ‚Äú77917324‚Äù,
‚ÄúCAR HALLS CHERRY 24X12X28g‚Äù: ‚Äú77987662‚Äù,
‚ÄúHALLS SFREE MENTA 18X12‚Äù: ‚Äú7622201802967‚Äù,
‚ÄúHALLS FREE CHERRY‚Äù: ‚Äú7622201802875‚Äù,
‚ÄúALF CHOC TOONIX 16PQX6X300GR‚Äù: ‚Äú77939234‚Äù,
‚ÄúALFAJOR TERRABUSI X 50 GRS.‚Äù: ‚Äú77939234‚Äù,
‚ÄúALF TERRA GLACEADO 48 x 38gr‚Äù: ‚Äú7622300202859‚Äù,
‚ÄúALFAJOR GLACE TOONIX 16X6X38G‚Äù: ‚Äú7622300202859‚Äù,
‚ÄúALF. MILKA MOUSSE LECHE 24x6x42GR.‚Äù: ‚Äú7622300759506‚Äù,
‚ÄúALF. MILKA MOUSSE LECHE  54x42GR.‚Äù: ‚Äú7622300759506‚Äù,
‚ÄúALF SHOT PASTA DE MANI 54X44G‚Äù: ‚Äú7622202304705‚Äù,
‚ÄúALFAJOR TERRABUSI CL√ÅSICO X 70 GRS.‚Äù: ‚Äú77903792‚Äù,
‚ÄúALFAJOR TERRABUSI TORTA X 70 GRS.‚Äù: ‚Äú77903860‚Äù,
‚ÄúALFAJOR MILKA MOUSSE TRIPLE X 55 GRS.‚Äù: ‚Äú77903785‚Äù,
‚ÄúALFAJOR MILKA TRIPLE DULCE DE LECHE X 70 GRS.‚Äù: ‚Äú77903778‚Äù,
‚ÄúALF MILKA TRIMOUSSE BCO 36x55G‚Äù: ‚Äú7622300457303‚Äù,
‚ÄúALFAJOR TRIPLE SHOT X 60 GRS.‚Äù: ‚Äú77956699‚Äù,
‚ÄúALFAJOR TRIPLE PEPITOS X 57 GRS.‚Äù: ‚Äú77915481‚Äù,
‚ÄúALFAJOR MILA OREO DDL‚Äù: ‚Äú7622300835620‚Äù,
‚ÄúAlf Triple Oreo 2020 36 X 56 Gr‚Äù: ‚Äú77976307‚Äù,
‚ÄúALF SIMPLE TITA 54X36G‚Äù: ‚Äú77908308‚Äù,
‚ÄúMINI ALFAJOR MILKA MOUSSE 16X114G‚Äù: ‚Äú7622202220081‚Äù,
‚ÄúMINI ALFAJOR SHOT 16X114G‚Äù: ‚Äú7622202223389‚Äù,
‚ÄúTAB CADBURY TRES SUEN 2021 12X12X25‚Äù: ‚Äú7622201818579‚Äù,
‚ÄúCADBURY INTENSE 2021 12X12X25G‚Äù: ‚Äú7622201818609‚Äù,
‚ÄúTAB CADBURY YOG FRUT 2021 12X12X29‚Äù: ‚Äú7622201818654‚Äù,
‚ÄúTAB CADBURY YOG FRUT 2021 28X82G‚Äù: ‚Äú7622201818715‚Äù,
‚ÄúTAB CADBURY TRES SUENOS 2021 28X82G‚Äù: ‚Äú7622201818739‚Äù,
‚ÄúTAB CADBURY ALMENDRAS 28X82G‚Äù: ‚Äú7622201807405‚Äù,
‚ÄúTAB CADBURY INTENSE 24X162G‚Äù: ‚Äú7622201800505‚Äù,
‚ÄúTAB CADBURY YOG FRUT 2021 24X162G‚Äù: ‚Äú7622201818692‚Äù,
‚ÄúMILKA OREO BOMBON 30DX11UX19G ARG‚Äù: ‚Äú77971630‚Äù,
‚ÄúMINI RHODESIA 54X60G‚Äù: ‚Äú7622300335090‚Äù,
‚ÄúRHODESIA 12 EST. x 36U. x 22GR.‚Äù: ‚Äú77995681‚Äù,
‚ÄúRHODESIA CHOCOLATE 12X36X22G ‚Äù: ‚Äú7622201142223‚Äù,
‚ÄúRHODESIA TOONIX 62AGRX4PZX22GR‚Äù: ‚Äú77995681‚Äù,
‚ÄúMILKA CHOCOPAUSE REGULAR 4x24x45GR‚Äù: ‚Äú7622201492717‚Äù,
‚ÄúMILKA CHOCOPAUSE OREO 4x24x45GR‚Äù: ‚Äú7622201492465‚Äù,
‚ÄúHABANITOS 54X60G‚Äù: ‚Äú7622300335076‚Äù,
‚ÄúSNACKY 54X60G‚Äù: ‚Äú7622300335052‚Äù,
‚ÄúMILKA BIS MILK EXP 65UNX105,6G ‚Äù: ‚Äú7622210788207‚Äù,
‚ÄúMILKA BIS OREO 65UNX105,6G EXP‚Äù: ‚Äú7622210719829‚Äù,
‚ÄúTITA 2021 AG 69X5X19G‚Äù: ‚Äú77976291‚Äù,
‚ÄúTOBLERONE LECHE 20x100GR.‚Äù: ‚Äú7614500010013‚Äù,
‚ÄúTOBLERONE 24X35G PACK‚Äù: ‚Äú77994066‚Äù,
‚ÄúLILA GO OREO 36CSEX37GR ARG‚Äù: ‚Äú7622210828606‚Äù,
‚ÄúMILKA MILK 12DSX20UNX20G EXP‚Äù: ‚Äú7622210795625‚Äù,
‚ÄúMILKA DDL 30X67,5G‚Äù: ‚Äú7622300844943‚Äù,
‚ÄúMILKA DDL BLANCO 30X 67,5G‚Äù: ‚Äú7622300844967‚Äù,
‚ÄúMILKA DDL LECHE 24X135G‚Äù: ‚Äú7622300846565‚Äù,
‚ÄúMILKA BLANCO 4DSX21UNX55G EXP‚Äù: ‚Äú7622210745583‚Äù,
‚ÄúMILKA LECHE 4DSX21UNX55G EXP‚Äù: ‚Äú7622210745224‚Äù,
‚ÄúMILKA LECHE 4X12X150 GRS‚Äù: ‚Äú7622300990114‚Äù,
‚ÄúMILKA CHOCO SWING 12 X 300GR‚Äù: ‚Äú9012200872739‚Äù,
‚ÄúMILKA ALMENDRAS 4DSX21UNX55G EXP‚Äù: ‚Äú7622210745620‚Äù,
‚ÄúMILKA ALMENDRAS 4X12X155G‚Äù: ‚Äú7622300990152‚Äù,
‚ÄúMILKA CASTANA 4DSX21UNX55G EXP‚Äù: ‚Äú7622210745293‚Äù,
‚ÄúMILKA CASTA√ëAS 4X12X155G‚Äù: ‚Äú7622300990183‚Äù,
‚ÄúMILKA OREO BLANCO 12DSX20UNX20G EXP‚Äù: ‚Äú7622210795908‚Äù,
‚ÄúMILKA OREO BLANCO 4DSX21UNX55G EXP‚Äù: ‚Äú7622210745132‚Äù,
‚ÄúMILKA OREO 22UNX100G‚Äù: ‚Äú7622300631574‚Äù,
‚ÄúMilka Oreo Blanco 4X12x155g‚Äù: ‚Äú7622300990213‚Äù,
‚ÄúMilka Oreo 300g‚Äù: ‚Äú7622210277503‚Äù,
‚ÄúMILKA 95G WHOLE NUTS 17CA‚Äù: ‚Äú7622202257599‚Äù,
‚ÄúTAB MILKA LEG B LECH 2021 28X50G‚Äù: ‚Äú7622201818937‚Äù,
‚ÄúTAB MILKA LEG B COMB 2021 28X50G‚Äù: ‚Äú7622201818951‚Äù,
‚ÄúTAB MILKA LEG ALMEN 2021 28X50G‚Äù: ‚Äú7622201818975‚Äù,
‚ÄúTAB MILKA LEG B LECH 2021 24X110G‚Äù: ‚Äú7622201812744‚Äù,
‚ÄúTAB MILKA LEG B COMB 2021 24X110G‚Äù: ‚Äú7622201812775‚Äù,
‚ÄúTAB MILKA LEG ALM 2021 24X110G‚Äù: ‚Äú7622201812805‚Äù,
‚ÄúMILKA LECHE 4DSX21UNX55G VC‚Äù: ‚Äú7622210745224‚Äù,
‚ÄúMILKA ALMENDRAS 4DSX21UNX55G VC ‚Äù: ‚Äú7622210745620‚Äù,
‚ÄúMILKA LECHE 4DSX12UNX150G VC ‚Äú: ‚Äú7622300990114‚Äù,
‚ÄúMILKA ALMENDRAS 4DSX12UNX155G VC‚Äù: ‚Äú7622300990152‚Äù,
‚ÄúMILKA  20x90G TRIPLE CHOCOLATE ‚Äù: ‚Äú7622210609908‚Äù,
‚ÄúMILKA 20x90G TRIPLE CARAMEL‚Äù: ‚Äú7622210609885‚Äù,
‚ÄúMILKA WHOLENUTS 13X270GR‚Äù: ‚Äú7622210693266‚Äù,
‚ÄúMKA 300G STRAWB CHEESECAKE 12CA‚Äù: ‚Äú7622210678171‚Äù,
‚ÄúMKA OREO BROWNIE 100g 22CA‚Äù: ‚Äú7622210953421‚Äù,
‚ÄúMILKA CAR Y AVELL ENT 12X300G‚Äù: ‚Äú7622300134532‚Äù,
‚ÄúMKA 100G COOKIES 22CA‚Äù: ‚Äú7622201424848‚Äù,
‚ÄúMKA 300G TABLET ALMOND CARAMEL 12CA.‚Äù: ‚Äú7622210732507‚Äù,
‚ÄúMKA 100G RASPB 22CA RO‚Äù: ‚Äú7622300590062‚Äù,
‚ÄúMKA 250G LUFLEE CARAMEL 10CA‚Äù: ‚Äú7622300757717‚Äù,
‚ÄúTAB MILKA DDL LECHE 36X29G‚Äù: ‚Äú7622202322068‚Äù,
‚ÄúTAB MILKA DDL BLANCO 36X29G‚Äù: ‚Äú7622202322129‚Äù,
‚ÄúMILKA AIREADO LECHE 12X16X25G‚Äù: ‚Äú7622202322150‚Äù,
‚ÄúMILKA AIREADO COMBINADO 12X16X25G‚Äù: ‚Äú7622202322181‚Äù,
‚ÄúTABLETA SHOT 6x25x35 GR.‚Äù: ‚Äú77914217‚Äù,
‚ÄúSHOT 6X25X35G‚Äù: ‚Äú77914217‚Äù,
‚ÄúSHOT 20UNX170G 2020 ‚Äú: ‚Äú7622300424084‚Äù,
‚Äú TABLETA SHOT 36X90G VC‚Äù: ‚Äú7791249451656‚Äù,
‚ÄúSHOT BLANCO 6DSX25UNX35G EXP‚Äù: ‚Äú77983992‚Äù,
‚ÄúTITA 12X36X19G‚Äù: ‚Äú77976291‚Äù,
‚ÄúGEL LIGHT FRUTOS ROJOS HS 12X8X25G‚Äù: ‚Äú7622300865610‚Äù,
‚ÄúGEL SIN SABOR NEW HS 16X8X14G ‚Äú: ‚Äú7622201106034‚Äù,
‚ÄúPolvo para hornear Royal 50G‚Äù: ‚Äú7622201464882‚Äù,
‚ÄúPOLVO HORNEAR X 100 GR.‚Äù: ‚Äú7622300148119‚Äù,
‚ÄúBIZCOCHUELO ROYAL VAINILLA 10X500G ‚Äú: ‚Äú7622201806651‚Äù,
‚ÄúBIZCOCHUELO ROYAL CHOCOLATE 10X500G ‚Äú: ‚Äú7622201806668‚Äù,
‚ÄúFLAN VAINILLA 6X6X60G ‚Äú: ‚Äú7622300871550‚Äù,
‚ÄúMOUSSE LIGHT CHOCO 6X6X40G‚Äù: ‚Äú7622300871772‚Äù,
‚ÄúPOSTRE CHOCOLATE 6X6X65G ‚Äú: ‚Äú7622300989934‚Äù,
‚ÄúPOSTRE LIGHT VAINILLA 6X6X43G‚Äù: ‚Äú7622300871970‚Äù,
‚ÄúGEL REG FRUTILLA 12X8X25G‚Äù: ‚Äú7622201819620‚Äù,
‚ÄúGEL REG FRAMBUESA 12X8X25G‚Äù: ‚Äú7622201819668‚Äù,
‚ÄúGEL REG CEREZA 12X8X25G‚Äù: ‚Äú7622201819699‚Äù,
‚ÄúGEL REG DURAZNO 12X8X25G‚Äù: ‚Äú7622201820534‚Äù,
‚ÄúGEL REG NARANJA 12X8X22G‚Äù: ‚Äú7622201820473‚Äù,
‚ÄúGEL LIGHT FRUTILLA 2022 12X8X25G‚Äù: ‚Äú7622201820596‚Äù,
‚ÄúGEL LIGHT CEREZA 2022 12X8X25G‚Äù: ‚Äú7622201819736‚Äù,
‚ÄúGEL LIGHT FRUT ROJOS 2022 12X8X25G‚Äù: ‚Äú7622201820565‚Äù,
‚ÄúFLAN VAINILLA 2022 6X6X60G ‚Äú: ‚Äú7622201705268‚Äù,
‚ÄúFLAN LIGHT VAINILLA 2022 6X10X16G ‚Äú: ‚Äú7622201705299‚Äù,
‚ÄúMOUSSE CHOCOLATE 2022 6X6X65G ‚Äú: ‚Äú7622201706029‚Äù,
‚ÄúMOUSSE LIGHT CHOCO 2022 6X6X40G ‚Äú: ‚Äú7622201705138‚Äù,
‚ÄúPOSTRE VAINILLA 2022 6X6X75G ‚Äú: ‚Äú7622201704643‚Äù,
‚ÄúPOSTRE CHOCOLATE 2022 6X6X65G ‚Äú: ‚Äú7622201705169‚Äù,
‚ÄúPOSTRE FRUTILLA 2022 6X6X75G ‚Äú: ‚Äú7622201704674‚Äù,
‚ÄúPOSTRE DDL 2022 6X6X75G ‚Äú: ‚Äú7622300871949‚Äù,
‚ÄúPOSTRE LIGHT VAINILLA 2022 6X6X43G ‚Äú: ‚Äú7622201705077‚Äù,
‚ÄúPOSTRE LIGHT CHOCO 2022 6X6X50G ‚Äú: ‚Äú7622201705107‚Äù,
‚ÄúCREMA CHANTILLY 2022 6X6X50G‚Äù: ‚Äú7622201705480‚Äù,
‚ÄúBELDENT MANDARINA 20X20‚Äù: ‚Äú77981844‚Äù,
‚ÄúBELDENT SANDIA 20X20 ‚Äú: ‚Äú77987686‚Äù,
‚ÄúBELDENT TROPICAL MIX 20X20‚Äù: ‚Äú7622202273131‚Äù,
‚ÄúBELDENT MENTA QI POSEIDON 20X20‚Äù: ‚Äú77969071‚Äù,
‚ÄúBELDENT MENTA FUERTE QI POSEI 20X20‚Äù: ‚Äú77969088‚Äù,
‚ÄúBELDENT MENTOL QI POSEIDON 20X20‚Äù: ‚Äú77969095‚Äù,
‚ÄúCH BELDENT GLOBO QI POSEIDON 20X20‚Äù: ‚Äú77969101‚Äù,
‚ÄúBELDENT FRUTILLA QI POSEIDON 20X20‚Äù: ‚Äú77969118‚Äù,
‚ÄúBELDENT MENTA X7 20X15X13.3G ‚Äú: ‚Äú7622201421496‚Äù,
‚ÄúBELD SPEARMINT X7 20X15X13.3G ‚Äú: ‚Äú7622201448226‚Äù,
‚ÄúBELD MANDARINA X7 20X15X13.3G ‚Äú: ‚Äú7622201448288‚Äù,
‚ÄúBELD BLUEBERRY X7 20X15X13.3G ‚Äú: ‚Äú7622201448325‚Äù,
‚ÄúBELDENT INF QI MENTA 14 12X12X26.6G ‚Äú: ‚Äú7622201457334‚Äù,
‚ÄúBELD INF QI SPEARM 14 12X12X26.6G ‚Äú: ‚Äú7622201457396‚Äù,
‚ÄúBELD INF QI CITRUS 14 12X12X26.6G ‚Äú: ‚Äú7622201457426‚Äù,
‚ÄúBELD INF QI BLUEBERRY 14 12X12X26.6G ‚Äú: ‚Äú7622201457457‚Äù,
‚ÄúBUBBA MENTA 32DX60UX5G  ‚Äù: ‚Äú77982346‚Äù,
‚ÄúBUBBA TUTTI 32DX60UX5G SC‚Äù: ‚Äú77982353‚Äù,
‚ÄúBUBBA FRUTILLA 32DX60UX5G SC‚Äù: ‚Äú77982360‚Äù,
‚ÄúBUBBA UVA 32DX60UX5G SC‚Äù: ‚Äú77982377‚Äù,
‚ÄúCLIGHT LIMO ROSA VITC+D 16X20X7,5G‚Äù: ‚Äú7622201682026‚Äù,
‚ÄúCLIGHT ANANA 2022 16X20X7G‚Äù: ‚Äú7622201702625‚Äù,
‚ÄúCLIGHT LIMONADA 2022 16X20X8G‚Äù: ‚Äú7622201702656‚Äù,
‚ÄúCLIGHT NAR MANGO 2022 16X20X7G‚Äù: ‚Äú7622201702687‚Äù,
‚ÄúCLIGHT NAR DURA 2022 16X20X7.5G‚Äù: ‚Äú7622201702717‚Äù,
‚ÄúCLIGHT MAN VER 2022 16X20X7.5G‚Äù: ‚Äú7622201703059‚Äù,
‚ÄúCLIGHT MANZ DELI 2022 16X20X7G‚Äù: ‚Äú7622201703080‚Äù,
‚ÄúCLIGHT LIMO MARACUYA 16X20X7,5G‚Äù: ‚Äú7622201733834‚Äù,
‚ÄúCLIGHT NARANJA 2022 16X20X8G‚Äù: ‚Äú7622201703110‚Äù,
‚ÄúCLIGHT NAR DUL 2022 16X20X7.5G‚Äù: ‚Äú7622201703141‚Äù,
‚ÄúCLIGHT POM ROSA 2022 16X20X8G‚Äù: ‚Äú7622201703172‚Äù,
‚ÄúCLIGHT PERA 2022 16X20X7G‚Äù: ‚Äú7622201703202‚Äù,
‚ÄúCLIGHT POM AMA 2022 16X20X8G‚Äù: ‚Äú7622201703233‚Äù,
‚ÄúCLIGHT MANDARINA 2022 16X20X8G‚Äù: ‚Äú7622201704148‚Äù,
‚ÄúCLIGHT NJA STEVIA 2022 16X16X9.5G‚Äù: ‚Äú7622201704551‚Äù,
‚ÄúCLIGHT LIMO STEV 2022 16X16X7.5G‚Äù: ‚Äú7622201704582‚Äù,
‚ÄúCLIGHT MANZ STEV 2022 16X16X7.5G‚Äù: ‚Äú7622201704612‚Äù,
‚ÄúCLIGHT LIMONADA ARANDANOS 16X20X8G‚Äù: ‚Äú7622202236846‚Äù,
‚ÄúTANG FRUTILLA 12X20X15G‚Äù: ‚Äú7622201746490‚Äù,
‚ÄúTANG NARANJA 12X20X15G‚Äù: ‚Äú7622201705961‚Äù,
‚ÄúTANG MANZANA 12X20X15G‚Äù: ‚Äú7622201705992‚Äù,
‚ÄúTANG NAR DULCE 12X20X15G‚Äù: ‚Äú7622201735340‚Äù,
‚ÄúTANG NAR MANGO 12X20X15G‚Äù: ‚Äú7622201735371‚Äù,
‚ÄúTANG LIMO DULCE 12X20X15G‚Äù: ‚Äú7622201735685‚Äù,
‚ÄúTANG MULTIFRUTA 12X20X15G‚Äù: ‚Äú7622201735715‚Äù,
‚ÄúTANG POM ROSA 12X20X15G‚Äù: ‚Äú7622201735746‚Äù,
‚ÄúTANG NAR BANANA 12X20X15G‚Äù: ‚Äú7622201735777‚Äù,
‚ÄúTANG NAR DURAZ 12X20X15G‚Äù: ‚Äú7622201745707‚Äù,
‚ÄúTANG PERA 12X20X15G‚Äù: ‚Äú7622201745738‚Äù,
‚ÄúTANG DURAZNO 12X20X15G‚Äù: ‚Äú7622201745936‚Äù,
‚ÄúTANG MIX NAR LIM 12X20X15G‚Äù: ‚Äú7622201746018‚Äù,
‚ÄúTANG MIX NJA FRU MAR 12X20X15G‚Äù: ‚Äú7622201746063‚Äù,
‚ÄúTANG UVA 12X20X15G‚Äù: ‚Äú7622201746117‚Äù,
‚ÄúTANG ANANA 12X20X15G‚Äù: ‚Äú7622201745967‚Äù,
‚ÄúTANG MANDARINA 12X20X15G‚Äù: ‚Äú7622201733865‚Äù,
‚ÄúVERAO NARANJA 2022 16X20X7G‚Äù: ‚Äú7622201717414‚Äù,
‚ÄúVERAO MANZANA 2022 16X20X7G‚Äù: ‚Äú7622201717445‚Äù,
‚ÄúVERAO NARANJA DURAZNO 2022 16X20X7G‚Äù: ‚Äú7622201717476‚Äù,
‚ÄúVERAO ANANA 2022 16X20X7G‚Äù: ‚Äú7622201717506‚Äù,
}

# -------------------
# üîπ Streamlit UI
# -------------------
st.title("üìä Precios Carrefour - API (Sucursal Hiper Olivos)")
st.write("Obtiene los precios de los productos listados directamente desde la API de Carrefour, aplicando la cookie de **Hiper Olivos**.")

if st.button("üîç Ejecutar scraping"):
    with st.spinner("‚è≥ Procesando... Esto puede tardar unos segundos"):
        resultados = []

        for nombre, product_id in productos.items():
            try:
                url = f"https://www.carrefour.com.ar/api/catalog_system/pub/products/search?fq=productId:{product_id}"
                r = requests.get(url, headers=HEADERS, timeout=10)
                data = r.json()

                if not data:
                    resultados.append({"productId": product_id, "Nombre": nombre, "Precio": "‚ùå Sin datos"})
                    continue

                offer = data[0]['items'][0]['sellers'][0]['commertialOffer']
                price_list = offer.get('ListPrice', 0)
                price = offer.get('Price', 0)

                # Preferimos precio de lista si existe, sino precio actual
                final_price = price_list if price_list > 0 else price

                if final_price > 0:
                    precio_formateado = f"{final_price:,.2f}".replace(",", "X").replace(".", ",").replace("X", "")
                    resultados.append({"productId": product_id, "Nombre": nombre, "Precio": precio_formateado})
                else:
                    resultados.append({"productId": product_id, "Nombre": nombre, "Precio": "no hay stock"})

            except Exception:
                resultados.append({"productId": product_id, "Nombre": nombre, "Precio": "‚ö†Ô∏è Error"})

        # --- Crear DataFrame y mostrarlo
        df = pd.DataFrame(resultados, columns=["productId", "Nombre", "Precio"])
        st.success("‚úÖ Scraping completado v√≠a API")
        st.dataframe(df)

        # --- Bot√≥n de descarga CSV
        fecha = datetime.now().strftime("%Y-%m-%d")
        csv = df.to_csv(index=False).encode('utf-8')
        st.download_button(
            label="‚¨á Descargar CSV",
            data=csv,
            file_name=f"precios_hiper_olivos_{fecha}.csv",
            mime="text/csv",
        )
